trigger OrderTotalTrigger on HandsMen_Order__c (before insert, before update) {
    Set<Id> inventoryIds = new Set<Id>();

    for (HandsMen_Order__c order : Trigger.new) {
        if (order.Inventory_Reference__c != null) {
            inventoryIds.add(order.Inventory_Reference__c);
        }
    }

    Map<Id, Inventory__c> inventoryMap = new Map<Id, Inventory__c>(
        [SELECT Id, Product__r.Price__c FROM Inventory__c WHERE Id IN :inventoryIds]
    );

    for (HandsMen_Order__c order : Trigger.new) {
        if (order.Inventory_Reference__c != null && inventoryMap.containsKey(order.Inventory_Reference__c)) {
            Inventory__c inventory = inventoryMap.get(order.Inventory_Reference__c);
            Decimal price = inventory.Product__r.Price__c;
            if (order.Quantity__c != null && price != null) {
                order.Total_Amount__c = order.Quantity__c * price;
            }
        }
    }
}
